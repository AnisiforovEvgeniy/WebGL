(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Y=1e-6,K=typeof Float32Array<"u"?Float32Array:Array;function b(){var e=new K(16);return K!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function le(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function X(e,r,t){var i=r[0],a=r[1],s=r[2],c=r[3],y=r[4],v=r[5],R=r[6],h=r[7],m=r[8],p=r[9],o=r[10],g=r[11],M=r[12],P=r[13],F=r[14],L=r[15],l=t[0],f=t[1],d=t[2],A=t[3];return e[0]=l*i+f*y+d*m+A*M,e[1]=l*a+f*v+d*p+A*P,e[2]=l*s+f*R+d*o+A*F,e[3]=l*c+f*h+d*g+A*L,l=t[4],f=t[5],d=t[6],A=t[7],e[4]=l*i+f*y+d*m+A*M,e[5]=l*a+f*v+d*p+A*P,e[6]=l*s+f*R+d*o+A*F,e[7]=l*c+f*h+d*g+A*L,l=t[8],f=t[9],d=t[10],A=t[11],e[8]=l*i+f*y+d*m+A*M,e[9]=l*a+f*v+d*p+A*P,e[10]=l*s+f*R+d*o+A*F,e[11]=l*c+f*h+d*g+A*L,l=t[12],f=t[13],d=t[14],A=t[15],e[12]=l*i+f*y+d*m+A*M,e[13]=l*a+f*v+d*p+A*P,e[14]=l*s+f*R+d*o+A*F,e[15]=l*c+f*h+d*g+A*L,e}function fe(e,r,t,i){var a=i[0],s=i[1],c=i[2],y=Math.sqrt(a*a+s*s+c*c),v,R,h,m,p,o,g,M,P,F,L,l,f,d,A,E,x,B,T,w,I,_,C,O;return y<Y?null:(y=1/y,a*=y,s*=y,c*=y,v=Math.sin(t),R=Math.cos(t),h=1-R,m=r[0],p=r[1],o=r[2],g=r[3],M=r[4],P=r[5],F=r[6],L=r[7],l=r[8],f=r[9],d=r[10],A=r[11],E=a*a*h+R,x=s*a*h+c*v,B=c*a*h-s*v,T=a*s*h-c*v,w=s*s*h+R,I=c*s*h+a*v,_=a*c*h+s*v,C=s*c*h-a*v,O=c*c*h+R,e[0]=m*E+M*x+l*B,e[1]=p*E+P*x+f*B,e[2]=o*E+F*x+d*B,e[3]=g*E+L*x+A*B,e[4]=m*T+M*w+l*I,e[5]=p*T+P*w+f*I,e[6]=o*T+F*w+d*I,e[7]=g*T+L*w+A*I,e[8]=m*_+M*C+l*O,e[9]=p*_+P*C+f*O,e[10]=o*_+F*C+d*O,e[11]=g*_+L*C+A*O,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function de(e,r,t,i,a){var s=1/Math.tan(r/2);if(e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0){var c=1/(i-a);e[10]=(a+i)*c,e[14]=2*a*i*c}else e[10]=-1,e[14]=-2*i;return e}var Ae=de;function he(e,r,t,i){var a,s,c,y,v,R,h,m,p,o,g=r[0],M=r[1],P=r[2],F=i[0],L=i[1],l=i[2],f=t[0],d=t[1],A=t[2];return Math.abs(g-f)<Y&&Math.abs(M-d)<Y&&Math.abs(P-A)<Y?le(e):(h=g-f,m=M-d,p=P-A,o=1/Math.sqrt(h*h+m*m+p*p),h*=o,m*=o,p*=o,a=L*p-l*m,s=l*h-F*p,c=F*m-L*h,o=Math.sqrt(a*a+s*s+c*c),o?(o=1/o,a*=o,s*=o,c*=o):(a=0,s=0,c=0),y=m*c-p*s,v=p*a-h*c,R=h*s-m*a,o=Math.sqrt(y*y+v*v+R*R),o?(o=1/o,y*=o,v*=o,R*=o):(y=0,v=0,R=0),e[0]=a,e[1]=y,e[2]=h,e[3]=0,e[4]=s,e[5]=v,e[6]=m,e[7]=0,e[8]=c,e[9]=R,e[10]=p,e[11]=0,e[12]=-(a*g+s*M+c*P),e[13]=-(y*g+v*M+R*P),e[14]=-(h*g+m*M+p*P),e[15]=1,e)}const ve=`#version 300 es
    in vec4 aPosition;
    uniform mat4 uCameraMatrix;

    void main(){
        gl_Position = uCameraMatrix * aPosition;
    }
`,me=`#version 300 es
    precision highp float;
    uniform vec4 uColor;

    out vec4 outColor;

    void main(){
        outColor = uColor;
    }
`;function pe(e,r){const t=r.getBoundingClientRect(),a=window.devicePixelRatio*t.width;r.width=a,r.height=a,e.viewport(0,0,a,a)}function $(e,r,t){const i=e.createShader(r);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.error(e.getShaderInfoLog(i)),null)}function ye(e,r,t){const i=e.createProgram();return e.attachShader(i,r),e.attachShader(i,t),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)?i:(console.error(e.getProgramInfoLog(i)),null)}function U(e,r,t){const i=e.createVertexArray();return e.bindVertexArray(i),e.bindBuffer(e.ARRAY_BUFFER,r),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,3,e.FLOAT,!1,0,0),e.bindVertexArray(null),i}const k=new Float32Array([-1,-.75,0,-1,-.75,-.7,-.3,-.75,0,-1,-.75,-.7,-.3,-.75,-.7,-.3,-.75,0,-1,.75,0,-1,.75,-.7,-.3,.75,0,-1,.75,-.7,-.3,.75,-.7,-.3,.75,0,-1,-.75,0,-.3,-.75,0,-1,.75,0,-.3,-.75,0,-1,.75,0,-.3,.75,0,-1,-.75,-.7,-.3,-.75,-.7,-1,.75,-.7,-.3,-.75,-.7,-1,.75,-.7,-.3,.75,-.7,-1,-.75,0,-1,.75,0,-1,.75,-.7,-1,-.75,0,-1,-.75,-.7,-1,.75,-.7,-.3,-.75,0,-.3,.75,0,-.3,.75,-.7,-.3,-.75,0,-.3,-.75,-.7,-.3,.75,-.7]),ee=new Float32Array([-1,-.75,0,-.3,-.75,0,-1,.75,0,-.3,.75,0,-1,-.75,0,-1,.75,0,-.3,-.75,0,-.3,.75,0,-1,-.75,-.7,-.3,-.75,-.7,-1,.75,-.7,-.3,.75,-.7,-1,-.75,-.7,-1,.75,-.7,-.3,-.75,-.7,-.3,.75,-.7,-1,-.75,0,-1,-.75,-.7,-1,.75,0,-1,.75,-.7,-.3,-.75,0,-.3,-.75,-.7,-.3,.75,0,-.3,.75,-.7]),re=new Float32Array([0,-.5,0,1,-.5,0,.5,.5,0]),ne=new Float32Array([0,-.5,0,1,-.5,0,1,-.5,0,.5,.5,0,.5,.5,0,0,-.5,0]),S=document.getElementById("canvas"),n=S.getContext("webgl2");n||alert("webgl2 не работает!!!");const Re=$(n,n.VERTEX_SHADER,ve),ge=$(n,n.FRAGMENT_SHADER,me),D=ye(n,Re,ge);n.useProgram(D);const ae=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,ae);n.bufferData(n.ARRAY_BUFFER,k,n.STATIC_DRAW);const te=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,te);n.bufferData(n.ARRAY_BUFFER,ee,n.STATIC_DRAW);const ie=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,ie);n.bufferData(n.ARRAY_BUFFER,re,n.STATIC_DRAW);const se=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,se);n.bufferData(n.ARRAY_BUFFER,ne,n.STATIC_DRAW);const z=n.getAttribLocation(D,"aPosition"),V=n.getUniformLocation(D,"uColor"),J=n.getUniformLocation(D,"uCameraMatrix"),Me=U(n,ae,z),Pe=U(n,te,z),Fe=U(n,ie,z),Le=U(n,se,z),Q=b(),Z=b(),q=b();let N=3.5,W=Math.PI/2,u=.4,j=!1,G=0,H=0;S.addEventListener("mousedown",e=>{e.button===0&&(j=!0,G=e.clientX,H=e.clientY,S.style.cursor="grabbing")});window.addEventListener("mouseup",()=>{j=!1,S.style.cursor="grab"});S.addEventListener("mousemove",e=>{if(!j)return;const r=e.clientX-G,t=e.clientY-H,i=.007;W-=r*i,u-=t*i,u=Math.max(-Math.PI/2+.01,Math.min(Math.PI/2-.01,u)),G=e.clientX,H=e.clientY,ce(),oe()});function ce(){const e=N*Math.cos(u)*Math.cos(W),r=N*Math.sin(u),t=N*Math.cos(u)*Math.sin(W);he(Z,[e,r,t],[0,0,0],[0,1,0]),Ae(Q,45*Math.PI/180,S.width/S.height,.1,100),X(q,Q,Z)}function oe(){n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);const e=b(),r=b();X(r,q,e),n.uniformMatrix4fv(J,!1,r),n.uniform4f(V,0,.6,.9,1),n.bindVertexArray(Me),n.drawArrays(n.TRIANGLES,0,k.length/3),n.uniform4f(V,0,0,0,1),n.bindVertexArray(Pe),n.drawArrays(n.LINES,0,ee.length/3);const t=b();fe(t,t,45*Math.PI/180,[-1,0,0]);const i=b();X(i,q,t),n.uniformMatrix4fv(J,!1,i),n.uniform4f(V,.188,.835,.784,1),n.bindVertexArray(Fe),n.drawArrays(n.TRIANGLES,0,re.length/3),n.uniform4f(V,0,0,0,1),n.bindVertexArray(Le),n.drawArrays(n.LINES,0,ne.length/3)}pe(n,S);ce();oe();
